# AOKhmer v2.2 - Environment Configuration Template
# Copy this file to .env.v2.2 and fill in your actual values
# DO NOT commit .env.v2.2 to version control!

# =============================================================================
# OPENROUTER API (Primary LLM Gateway)
# =============================================================================
OPENROUTER_API_KEY=your_openrouter_api_key_here
OPENROUTER_BASE_URL=https://openrouter.ai/api/v1

# Default models (can be overridden per request)
OPENROUTER_DEFAULT_MODEL=openrouter/auto
OPENROUTER_VISION_MODEL=google/gemini-2.0-flash-thinking-exp:free
OPENROUTER_CODING_MODEL=qwen/qwen3-coder-next

# Optional: OpenRouter-specific settings
OPENROUTER_SITE_URL=https://aokhmer.app
OPENROUTER_SITE_NAME=AOKhmer

# =============================================================================
# GOOGLE GEMINI API (Fallback & Vision)
# =============================================================================
GOOGLE_API_KEY=your_google_api_key_here
GEMINI_MODEL=gemini-2.0-flash-thinking-exp
GEMINI_VISION_MODEL=gemini-2.0-flash-thinking-exp

# =============================================================================
# SUPABASE PGVECTOR - UNIFIED STORAGE (v2.3)
# Replaces ChromaDB with Supabase + pgvector for zero data drift
# =============================================================================
SUPABASE_URL=https://your-project.supabase.co
SUPABASE_ANON_KEY=your_anon_key_here
SUPABASE_SERVICE_KEY=your_service_role_key_here
SUPABASE_JWT_SECRET=your_jwt_secret_here

# pgvector configuration
PGVECTOR_ENABLED=true
PGVECTOR_DIMENSION=1536

# Database connection string (for direct access)
DATABASE_URL=postgresql://postgres:[PASSWORD]@db.[PROJECT_REF].supabase.co:5432/postgres
DIRECT_URL=postgresql://postgres:[PASSWORD]@db.[PROJECT_REF].supabase.co:5432/postgres

# =============================================================================
# REDIS - FOR CACHING & QUEUES
# =============================================================================
REDIS_URL=redis://localhost:6379/0
REDIS_PASSWORD=

# =============================================================================
# ELASTICSEARCH - FOR SEARCH
# =============================================================================
ELASTICSEARCH_URL=http://localhost:9200
ELASTICSEARCH_USERNAME=
ELASTICSEARCH_PASSWORD=
ELASTICSEARCH_INDEX_PREFIX=aokhmer

# =============================================================================
# OPENRAG - UNIFIED RETRIEVAL (v2.3)
# Replaces ChromaDB with OpenRAG + Supabase pgvector
# =============================================================================
OPENRAG_API_URL=http://localhost:8001
OPENRAG_API_KEY=your_openrag_api_key_if_using_cloud
OPENRAG_EMBEDDING_MODEL=text-embedding-3-large
OPENRAG_EMBEDDING_DIMENSION=1536
OPENRAG_MATCH_THRESHOLD=0.7
OPENRAG_MATCH_COUNT=20
OPENRAG_RERANK_TOP_K=5
OPENRAG_ENABLE_QUERY_EXPANSION=true

# =============================================================================
# LCI - CODE INDEX (v2.3)
# LCI continues to handle code-specific semantic search
# =============================================================================
LCI_ENABLED=true
LCI_MCP_PORT=3000

# =============================================================================
# DIFY - AI WORKFLOW ENGINE
# =============================================================================
DIFY_API_KEY=your_dify_api_key
DIFY_BASE_URL=http://localhost:5001
DIFY_APP_ID=aokhmer_assistant
DIFY_DEFAULT_WORKFLOW=greeting_workflow

# =============================================================================
# N8N - WORKFLOW AUTOMATION
# =============================================================================
N8N_BASIC_AUTH_USER=admin
N8N_BASIC_AUTH_PASSWORD=change_me_in_production
N8N_ENCRYPTION_KEY=your_random_encryption_key_here
N8N_WEBHOOK_URL=https://your-domain.com/webhook

# =============================================================================
# PREFECT - ORCHESTRATION
# =============================================================================
PREFECT_API_URL=http://localhost:4200/api
PREFECT_API_KEY=
PREFECT_WORK_QUEUE=aokhmer-default

# =============================================================================
# PROMETHEUS & GRAFANA - MONITORING
# =============================================================================
PROMETHEUS_PORT=9090
GRAFANA_PORT=3000
GRAFANA_ADMIN_USER=admin
GRAFANA_ADMIN_PASSWORD=change_me_in_production

# =============================================================================
# AGENT COORDINATION - MARS SYSTEM (v2.3)
# =============================================================================
MARS_COORDINATOR_URL=http://localhost:8000
MARS_AGENT_REGISTRY_PATH=./40-SOPs/AGENTS/
MARS_MEMORY_STORE=supabase_pgvector
MARS_ENABLE_CRITIQUE=true
MARS_ENABLE_SELF_IMPROVEMENT=true

# =============================================================================
# SECURITY
# =============================================================================
SECRET_KEY=your_super_secret_key_change_this_in_production
JWT_ALGORITHM=HS256
JWT_ACCESS_TOKEN_EXPIRE_MINUTES=30
JWT_REFRESH_TOKEN_EXPIRE_DAYS=7

# CORS Origins (comma-separated)
CORS_ORIGINS=http://localhost:3000,http://localhost:8080,https://aokhmer.app

# Rate Limiting
RATE_LIMIT_REQUESTS_PER_MINUTE=100
RATE_LIMIT_BURST=10

# =============================================================================
# STORAGE
# =============================================================================
S3_ENDPOINT=your_s3_compatible_endpoint
S3_ACCESS_KEY=your_access_key
S3_SECRET_KEY=your_secret_key
S3_BUCKET_NAME=aokhmer-storage
S3_REGION=us-east-1

# Local storage fallback
LOCAL_STORAGE_PATH=./storage

# =============================================================================
# EXTERNAL APIs
# =============================================================================
# YouTube Data API (for importing Khmer songs)
YOUTUBE_API_KEY=your_youtube_api_key

# Spotify API (for metadata)
SPOTIFY_CLIENT_ID=your_spotify_client_id
SPOTIFY_CLIENT_SECRET=your_spotify_client_secret

# Genius API (for lyrics)
GENIUS_ACCESS_TOKEN=your_genius_token

# =============================================================================
# FEATURE FLAGS
# =============================================================================
ENABLE_AI_FEATURES=true
ENABLE_VECTOR_SEARCH=true
ENABLE_REALTIME_FEATURES=true
ENABLE_ANALYTICS=true
ENABLE_RATE_LIMITING=true

# =============================================================================
# LOGGING
# =============================================================================
LOG_LEVEL=INFO
LOG_FORMAT=json
LOG_FILE=./logs/aokhmer.log

# =============================================================================
# DEVELOPMENT
# =============================================================================
DEBUG=false
HOT_RELOAD=true
TESTING=false

# =============================================================================
# DEPLOYMENT
# =============================================================================
ENVIRONMENT=development
DOMAIN=localhost
PORT=8000

# Docker
COMPOSE_PROJECT_NAME=aokhmer-v2

# =============================================================================
# BACKUP & MAINTENANCE
# =============================================================================
BACKUP_ENABLED=true
BACKUP_SCHEDULE=0 2 * * *
BACKUP_RETENTION_DAYS=30
BACKUP_S3_BUCKET=aokhmer-backups

# =============================================================================
# AHA DETECTOR SETTINGS
# =============================================================================
AHA_MIN_CONFIDENCE=0.7
AHA_KEYWORD_THRESHOLD=3
AHA_AUTO_COMMIT=false
AHA_REVIEW_REQUIRED=true

# =============================================================================
# PROJECT MAP GENERATOR
# =============================================================================
PROJECT_MAP_OUTPUT_PATH=PROJECT_MAP.md
PROJECT_MAP_INCLUDE_MERMAID=true
PROJECT_MAP_INCLUDE_METRICS=true
PROJECT_MAP_UPDATE_ON_CHANGE=true
